Installation
============

Installing Docker Engine
------------------------

ATB - Containerized Version uses `Docker Engine <https://docs.docker.com/engine/>`_ to both download and run the associated container.  

Distribution-specific instructions for installing Docker Engine are available `from Docker <https://docs.docker.com/engine/install/#server>`_.

.. warning::
    `Docker Desktop <https://www.docker.com/products/docker-desktop>`_ is a different product to Docker Engine and is distributed under a different license.  
    
    To avoid licensing issues, ensure that you select a download from the \"Server\" category rather than \"Desktop\".


After completing the installation instructions for Docker Engine, confirm that the installation has completed correctly by checking the output of:

.. code-block:: bash

    docker

(Optional) Configure Docker to Be Managed by Non-Root User
----------------------------------------------------------

As per the `Docker Documentation <https://docs.docker.com/engine/install/linux-postinstall/>`_:
    
    The Docker daemon binds to a Unix socket instead of a TCP port. By default that Unix socket is owned by the user root and other users can only access it using sudo. The Docker daemon always runs as the root user.

    If you don\'t want to preface the docker command with sudo, create a Unix group called docker and add users to it. When the Docker daemon starts, it creates a Unix socket accessible by members of the docker group.


Instructions for configuring Docker commands to be run without being prefaced by ``sudo`` are available from `Docker <https://docs.docker.com/engine/install/linux-postinstall/>`_.

.. warning::
    If this optional step is skipped, all ``docker`` commands listed in the rest of these installation instructions should be run with ``sudo``.
    
Installing ATB Docker Instance from File
----------------------------------------
Once docker is installed, download the ATB docker tar, this is approximately 9.8Gb (a link to the tar file is provided
when you buy a license with us, see our main `website <https://atb.uq.edu.au/>`_).

.. code-block:: python

    wget http://atb.uq.edu.au/example_link_to_docker_atb.tar


Load the docker image (may take a few minutes).

.. code-block:: python

    docker load -i atb-docker.tar


Running an instance
-------------------

.. code-block:: python

    docker run -d -p 8080:80 --name atb-server -v atbvol:/atb atb


Installing ATB Docker Instance from Docker Hub
----------------------------------------------
Once docker is installed, ensure you have access to the ATB Docker Hub repository.  Then pull the image from the repository using the following command:

.. code-block:: python

    docker pull martinstroet/atb-dev:atb-dev


Running an instance
-------------------

.. code-block:: python

   docker run -d -p 8080:80 --name atb-server -v atbvol:/atb martinstroet/atb-dev:atb-dev


.. list-table::
   :widths: 10 10
   :header-rows: 1

   * - ATB Release
     - Version
   * - 1
     - 3.0.0 
     
